units         metal
atom_style    atomic
atom_modify   map yes
newton        on

boundary p p p

read_data structure.data

variable        temperature equal 300.0
variable        temperature2 equal 300.0

variable        tempDamp equal 100.0 # approx 0.1 ps

variable        pressure equal 1.00
variable        pressureDamp equal 500.0

variable        seed world 14218

mass            1 12.011   # C
mass            2 1.007    # H
mass            3 14.0061  # N
mass            4 15.999   # O

pair_style  grace

pair_coeff * * /mnt/scratch2/q13camb_scratch/perovskites/CsPbI3_relaxed_structures/Grace/GRACE-1L-train/pero_1L_H100/restart_16_save/seed/1/saved_model C H N O


neighbor 1.0 bin
neigh_modify delay 5 every 1

write_dump all custom out.0.lammpstrj id type x y z fx fy fz

variable freq equal 100
variable dt equal 0.001

min_style cg
fix 1 all box/relax iso 0.0 vmax 0.005
minimize 1e-8 1e-8  100000 1000000
write_data      data.relax nocoeff nofix 
unfix 1

thermo          ${freq}
thermo_style    custom step temp pe ke etotal press lx ly lz xy xz yz
restart         ${freq} restart.0 restart.2

timestep        0.001

velocity        all create ${temperature} ${seed} dist gaussian

# NPT
dump            myDump3 all atom 1000 out.2.lammpstrj
fix             1 all temp/csvr ${temperature2} ${temperature2} $(500.0*dt) ${seed}
fix             2 all nph tri ${pressure} ${pressure} $(500.0*dt) 
fix             3 all momentum 10000 linear 1 1 1

run             10000000

unfix           1
unfix           2
unfix           3

undump          myDump3

write_restart   restart.file
write_data      data.eq
